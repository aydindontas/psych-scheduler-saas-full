<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Panel</title>
  <link rel="stylesheet" href="/static/style.css"/>
</head>
<body>
  <div class="container">
    <h1>Hoş geldin</h1>

    <p><span class="badge">Tenant</span> <span id="tenantKey">-</span></p>
    <p><span class="badge">E-posta</span> <span id="meEmail">-</span></p>

    <div class="row" style="margin-top:16px">
      <button onclick="location.assign('/schedule')">Randevu Planla</button>
      <button style="background:#2a3652" onclick="logout()">Çıkış</button>
    </div>

    <p class="helper" style="margin-top:12px">API Base: <input id="apiBase" readonly></p>
    <div id="status" class="helper"></div>
  </div>

<script>
const API = location.origin + "/api";
const token = localStorage.getItem("token");
if(!token){ location.replace("/static/Login.html"); }

const $ = id => document.getElementById(id);

async function loadMe(){
  try{
    const res = await fetch(API + "/me", { headers:{Authorization:"Bearer "+token} });
    if(!res.ok){ throw new Error("Yetkisiz"); }
    const me = await res.json();
    $("meEmail").textContent = me.email || "-";
    $("tenantKey").textContent = me.tenant?.tenant_key || "-";
    $("apiBase").value = API;
  }catch(e){
    localStorage.removeItem("token");
    location.replace("/static/Login.html");
  }
}
function logout(){
  localStorage.removeItem("token");
  location.assign("/static/Login.html");
}
loadMe();
</script>
</body>
</html>
